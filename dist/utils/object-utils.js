"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setPath = void 0;
exports.cloneDeep = cloneDeep;
const aws_eks_1 = require("aws-cdk-lib/aws-eks");
const lodash_1 = require("lodash");
const nutil = require("node:util/types");
const setPath = (obj, path, val) => {
    const keys = path.split('.');
    const lastKey = keys.pop();
    const lastObj = keys.reduce((obj, key) => obj[key] = obj[key] || {}, obj);
    lastObj[lastKey] = val;
};
exports.setPath = setPath;
/**
 * Creates a deep clone of an object, retaining types.
 * @param source
 * @param resolveFn if passed, this function can perform transformation (e.g. resolve proxies)
 * @returns
 */
function cloneDeep(source, resolveFn) {
    return (0, lodash_1.cloneDeepWith)(source, (value) => {
        if (value && (value instanceof aws_eks_1.KubernetesVersion || nutil.isProxy(value))) {
            return resolveFn ? resolveFn(value) : value;
        }
        return undefined;
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2JqZWN0LXV0aWxzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vbGliL3V0aWxzL29iamVjdC11dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFtQkEsOEJBT0M7QUExQkQsaURBQXdEO0FBQ3hELG1DQUF1QztBQUN2Qyx5Q0FBeUM7QUFFbEMsTUFBTSxPQUFPLEdBQUcsQ0FBQyxHQUFTLEVBQUUsSUFBWSxFQUFFLEdBQVEsRUFBRSxFQUFFO0lBQ3pELE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDN0IsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRyxDQUFDO0lBQzVCLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FDckMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLEVBQ3pCLEdBQUcsQ0FBQyxDQUFDO0lBQ1QsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLEdBQUcsQ0FBQztBQUMzQixDQUFDLENBQUM7QUFQVyxRQUFBLE9BQU8sV0FPbEI7QUFFRjs7Ozs7R0FLRztBQUNILFNBQWdCLFNBQVMsQ0FBSSxNQUFTLEVBQUUsU0FBNkI7SUFDakUsT0FBTyxJQUFBLHNCQUFhLEVBQUMsTUFBTSxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUU7UUFDbkMsSUFBRyxLQUFLLElBQUksQ0FBQyxLQUFLLFlBQVksMkJBQWlCLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDdkUsT0FBTyxTQUFTLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1FBQ2hELENBQUM7UUFDRCxPQUFPLFNBQVMsQ0FBQztJQUNyQixDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBLdWJlcm5ldGVzVmVyc2lvbiB9IGZyb20gXCJhd3MtY2RrLWxpYi9hd3MtZWtzXCI7XG5pbXBvcnQgeyBjbG9uZURlZXBXaXRoIH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCAqIGFzIG51dGlsIGZyb20gJ25vZGU6dXRpbC90eXBlcyc7XG5cbmV4cG9ydCBjb25zdCBzZXRQYXRoID0gKG9iaiA6IGFueSwgcGF0aDogc3RyaW5nLCB2YWw6IGFueSkgPT4geyBcbiAgICBjb25zdCBrZXlzID0gcGF0aC5zcGxpdCgnLicpO1xuICAgIGNvbnN0IGxhc3RLZXkgPSBrZXlzLnBvcCgpITtcbiAgICBjb25zdCBsYXN0T2JqID0ga2V5cy5yZWR1Y2UoKG9iaiwga2V5KSA9PiBcbiAgICAgICAgb2JqW2tleV0gPSBvYmpba2V5XSB8fCB7fSwgXG4gICAgICAgIG9iaik7IFxuICAgIGxhc3RPYmpbbGFzdEtleV0gPSB2YWw7XG59O1xuXG4vKipcbiAqIENyZWF0ZXMgYSBkZWVwIGNsb25lIG9mIGFuIG9iamVjdCwgcmV0YWluaW5nIHR5cGVzLiBcbiAqIEBwYXJhbSBzb3VyY2UgXG4gKiBAcGFyYW0gcmVzb2x2ZUZuIGlmIHBhc3NlZCwgdGhpcyBmdW5jdGlvbiBjYW4gcGVyZm9ybSB0cmFuc2Zvcm1hdGlvbiAoZS5nLiByZXNvbHZlIHByb3hpZXMpXG4gKiBAcmV0dXJucyBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsb25lRGVlcDxUPihzb3VyY2U6IFQsIHJlc29sdmVGbj86IChhcmc6IGFueSkgPT4gYW55ICk6IFQge1xuICAgIHJldHVybiBjbG9uZURlZXBXaXRoKHNvdXJjZSwgKHZhbHVlKSA9PiB7XG4gICAgICAgIGlmKHZhbHVlICYmICh2YWx1ZSBpbnN0YW5jZW9mIEt1YmVybmV0ZXNWZXJzaW9uIHx8IG51dGlsLmlzUHJveHkodmFsdWUpKSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc29sdmVGbiA/IHJlc29sdmVGbih2YWx1ZSkgOiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH0pO1xufVxuXG5leHBvcnQgdHlwZSBXcml0ZWFibGU8VD4gPSB7IC1yZWFkb25seSBbUCBpbiBrZXlvZiBUXTogVFtQXSB9OyJdfQ==